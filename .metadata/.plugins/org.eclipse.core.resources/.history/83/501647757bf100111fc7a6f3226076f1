package Banco;

import java.util.ArrayList;
import java.util.LinkedList;

import Locavel.Midia;
import RecursosHumanos.Cliente;

public class Banco {
	
	/*
	 * Declaração das listas do Banco 
	 */
	ArrayList<Midia> midia = new ArrayList<Midia>();
	ArrayList<Cliente> cliente = new ArrayList<Cliente>();
	
	public Banco() {
		this.midia = new ArrayList<Midia>();
	}
	
	/*
	 * Classes internas 
	 */
	
	private int retornaIndice ( ArrayList<Tabulavel> lista, String valorChave ) {
		
		int retorno = -1;
		Tabulavel registro;
		
		for (int i = 0; i < lista.size(); i++) {
			
			registro = lista.get(i);
			
			if ( registro != null ) {
							
				if ( registro.comparaCampoChave(valorChave) ) {
					retorno = i;
				}
				
			}
			
		}
		
		return retorno;
		
	}
	
	private int verificaChaveDuplicada ( ArrayList<Tabulavel> lista, String valorChave, int indiceNaoVerificado ) {
		
		int retorno = -1;
		Tabulavel registro;
		
		for (int i = 0; i < lista.size(); i++) {
			
			registro = lista.get(i);
			
			if ( registro != null ) {
			
				if ( registro.comparaCampoChave(valorChave) &&
					 i != indiceNaoVerificado  ) {
					retorno = i;
				}
				
			}
			
		}
		
		return retorno;
		
	}
	
	private void insereNaLista ( ArrayList<Tabulavel> lista, Tabulavel registro ) throws RegistroJaExiste {
			
		String indice = registro.retornaValorChave();
		int tamanho = lista.size();

		if ( retornaIndice(lista, indice) == -1 ) {
			registro.setIndice(tamanho);
			lista.add(tamanho,registro);
		}
		else {
			throw new RegistroJaExiste(registro.retornaValorChave());
		}
	}
		
	private void alteraNaLista ( ArrayList<Tabulavel> lista, Tabulavel registro ) throws RegistroInexistente, RegistroJaExiste {
		
		int indice = registro.getIndice();
		
		if ( verificaChaveDuplicada(lista, registro.retornaValorChave(), indice) != -1) {
			throw new RegistroJaExiste(registro.retornaValorChave());
		}
		
		if ( indice == -1 ) {
			throw new RegistroInexistente(registro.retornaValorChave());
		}
		else {
			lista.remove(indice);
			lista.add(indice,registro);
		}
	}
	
	private void removeDaLista ( ArrayList<Tabulavel> lista, String chave ) throws RegistroInexistente {
		
		int indice = retornaIndice(lista, chave);
		
		if ( indice == -1 ) {
			throw new RegistroInexistente(chave);
		}
		else {
			lista.set(indice, null);
		}
	}

	private void removeDaLista ( ArrayList<Tabulavel> lista, int indice ) throws RegistroInexistente {
		lista.set(indice, null);
	}
	
	private Tabulavel consultaDaLista ( ArrayList<Tabulavel> lista, String chave ) throws RegistroInexistente {
		
		int indice = retornaIndice(lista, chave);
		
		if ( indice == -1 ) {
			throw new RegistroInexistente(chave);
		}
		else {
			return lista.get(indice);
		}
	}

	private Tabulavel consultaDaLista ( ArrayList<Tabulavel> lista, int indice ) throws RegistroInexistente {
		
		Tabulavel registro = lista.get(indice);
		
		if ( registro == null ) {
			throw new RegistroInexistente("vazio");
		}
		
		return registro;
	}

	/*
	 * Classe para manipulação de Midia
	 */
	
    public void Insere ( Midia midia ) throws RegistroJaExiste{
		insereNaLista( (ArrayList) this.midia, (Tabulavel) midia);
	}
		
    public void ExcluiMidia ( String chave ) throws RegistroInexistente{
		removeDaLista( (ArrayList) this.midia, chave);
	}
	
    public void ExcluiMidia ( int indice ) throws RegistroInexistente{
		removeDaLista( (ArrayList) this.midia, indice);
	}
	
	public void Altera ( Midia midia) throws RegistroInexistente, RegistroJaExiste{
		alteraNaLista( (ArrayList) this.midia, (Tabulavel) midia);
	}
	
	public Midia ConsultaMidia ( String chave ) throws RegistroInexistente{
		return (Midia) consultaDaLista( (ArrayList) this.midia, chave);
	}
	
	public Midia ConsultaMidia ( int indice ) throws RegistroInexistente{
		return (Midia) consultaDaLista( (ArrayList) this.midia, indice);
	}
	
	public LinkedList<Midia> ListMidia () {

        LinkedList<Midia> lista = new LinkedList<Midia>();
        Midia registro;
       
        for (int i = 0; i < midia.size(); i++) {
           
            registro = midia.get(i);
           
            if ( registro != null ) {
           
                lista.add(registro);
               
            }
           
        }
       
        return lista;
    }
	
	/*
	 * Classe para manipulação de Cliente
	 */
	
    public void Insere ( Cliente cliente ) throws RegistroJaExiste{
    	System.out.println("Insere(Cliente).01");
		insereNaLista( (ArrayList) this.cliente, (Tabulavel) cliente);
		System.out.println("Insere(Cliente).01");
	}
		
    public void ExcluiCliente ( String chave ) throws RegistroInexistente{
		removeDaLista( (ArrayList) this.cliente, chave);
	}
	
    public void ExcluiCliente ( int indice ) throws RegistroInexistente{
		removeDaLista( (ArrayList) this.cliente, indice);
	}
	
	public void Altera ( Cliente cliente) throws RegistroInexistente, RegistroJaExiste{
		alteraNaLista( (ArrayList) this.cliente, (Tabulavel) cliente);
	}
	
	public Cliente ConsultaCliente ( String chave ) throws RegistroInexistente{
		return (Cliente) consultaDaLista( (ArrayList) this.cliente, chave);
	}
	
	public Cliente ConsultaCliente ( int indice ) throws RegistroInexistente{
		return (Cliente) consultaDaLista( (ArrayList) this.cliente, indice);
	}
	

    public LinkedList<Cliente> ListCliente () {
       
        LinkedList<Cliente> lista = new LinkedList<Cliente>();
        Cliente registro;
       
        for (int i = 0; i < cliente.size(); i++) {
           
            registro = cliente.get(i);
           
            if ( registro != null ) {
           
                lista.add(registro);
               
            }
           
        }
       
        return lista;
    }
	
	public void showMidia ( ) {
		
		Midia registro;
		
		for (int i = 0; i < midia.size(); i++) {
			
			registro = midia.get(i);
			
			if ( registro != null ) {
							
				System.out.println( "Mídia " + registro.getIndice() +
									" código " + registro.getCodigo() +
									" e descrição " + registro.getDescricao() + ".");
			
			}
			
		}
		
	}
	
}

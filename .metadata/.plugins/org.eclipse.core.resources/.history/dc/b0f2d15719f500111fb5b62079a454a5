package Banco;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.LinkedList;
import java.util.Map;
import java.util.Set;

import Locavel.Midia;
import RecursosHumanos.Cliente;

public class Banco {
	
	/*
	 * Declaração das listas do Banco 
	 */
	ArrayList<Midia> midia = new ArrayList<Midia>();
	ArrayList<Cliente> cliente = new ArrayList<Cliente>();
	
	Map<int, Midia> midias = new HashMap<int, Midia>();
	Map clientes = new HashMap();
	
	public Banco() {
		this.midia = new ArrayList<Midia>();
	}
	
	/*
	 * Classes internas 
	 */
	
	private int retornaIndice ( ArrayList<Tabelavel> lista, String valorChave ) {
		
		int retorno = -1;
		Tabelavel registro;
		
		for (int i = 0; i < lista.size(); i++) {
			
			registro = lista.get(i);
			
			if ( registro != null ) {
							
				if ( registro.comparaCampoChave(valorChave) ) {
					retorno = i;
				}
				
			}
			
		}
		
		return retorno;
		
	}
	
	private Tabelavel consultaDaLista ( ArrayList<Tabelavel> lista, String chave ) throws RegistroInexistente {
		
		int indice = retornaIndice(lista, chave);
		
		if ( indice == -1 ) {
			throw new RegistroInexistente(chave);
		}
		else {
			return lista.get(indice);
		}
	}

	private int verificaChaveDuplicada ( ArrayList<Tabelavel> lista, String valorChave, int indiceNaoVerificado ) {
		
		int retorno = -1;
		Tabelavel registro;
		
		for (int i = 0; i < lista.size(); i++) {
			
			registro = lista.get(i);
			
			if ( registro != null ) {
			
				if ( registro.comparaCampoChave(valorChave) &&
					 i != indiceNaoVerificado  ) {
					retorno = i;
				}
				
			}
			
		}
		
		return retorno;
		
	}
	
	private void insereNaLista ( ArrayList<Tabelavel> lista, Tabelavel registro ) throws RegistroJaExiste {
			
		String chave = registro.retornaValorChave();
		int tamanho = lista.size();

		if ( retornaIndice(lista, chave) == -1 ) {
			registro.setIndice(tamanho);
			lista.add(tamanho,registro);
		}
		else {
			throw new RegistroJaExiste(registro.retornaValorChave());
		}
		

	}
		
	private void alteraNaLista ( ArrayList<Tabelavel> lista, Tabelavel registro ) throws RegistroInexistente, RegistroJaExiste {
		
		int indice = registro.getIndice();
		
		if ( verificaChaveDuplicada(lista, registro.retornaValorChave(), indice) != -1) {
			throw new RegistroJaExiste(registro.retornaValorChave());
		}
		
		if ( indice == -1 ) {
			throw new RegistroInexistente(registro.retornaValorChave());
		}
		else {
			lista.remove(indice);
			lista.add(indice,registro);
		}
	}
	
	private void removeDaLista ( ArrayList<Tabelavel> lista, String chave ) throws RegistroInexistente {
		
		int indice = retornaIndice(lista, chave);
		
		if ( indice == -1 ) {
			throw new RegistroInexistente(chave);
		}
		else {
			lista.set(indice, null);
		}
	}

	private void removeDaLista ( ArrayList<Tabelavel> lista, int indice ) throws RegistroInexistente {
		if ( indice < lista.size() ) {
			lista.set(indice, null);
		}
		else {
			throw new RegistroInexistente(" "+indice+" ");
		}
	}
	
	private Tabelavel consultaDaLista ( ArrayList<Tabelavel> lista, int indice ) throws RegistroInexistente {
		
		Tabelavel registro = lista.get(indice);
		
		if ( registro == null ) {
			throw new RegistroInexistente("vazio");
		}
		
		return registro;
	}

	/*
	 * Classe para manipulação de Midia
	 */
	
    public void Insere ( Midia midia ) throws RegistroJaExiste{
		insereNaLista( (ArrayList) this.midia, (Tabelavel) midia);
	}
		
    public void ExcluiMidia ( String chave ) throws RegistroInexistente{
		removeDaLista( (ArrayList) this.midia, chave);
	}
	
    public void ExcluiMidia ( int indice ) throws RegistroInexistente{
		removeDaLista( (ArrayList) this.midia, indice);
	}
	
	public void Altera ( Midia midia) throws RegistroInexistente, RegistroJaExiste{
		alteraNaLista( (ArrayList) this.midia, (Tabelavel) midia);
	}
	
	public Midia ConsultaMidia ( String chave ) throws RegistroInexistente{
		return (Midia) consultaDaLista( (ArrayList) this.midia, chave);
	}
	
	public Midia ConsultaMidia ( int indice ) throws RegistroInexistente{
		return (Midia) consultaDaLista( (ArrayList) this.midia, indice);
	}
	
	public LinkedList<Midia> ListMidia () {

        LinkedList<Midia> lista = new LinkedList<Midia>();
        
        Midia registro;
       
        for (int i = 0; i < midia.size(); i++) {
           
            registro = midia.get(i);
           
            if ( registro != null ) {
           
                lista.add(registro);
               
            }
           
        }
       
        return lista;
    }
	
	/*
	 * Classe para manipulação de Cliente
	 */
	
    public void Insere ( Cliente cliente ) throws RegistroJaExiste{
		insereNaLista( (ArrayList) this.cliente, (Tabelavel) cliente);
	}
		
    public void ExcluiCliente ( String chave ) throws RegistroInexistente{
		removeDaLista( (ArrayList) this.cliente, chave);
	}
	
    public void ExcluiCliente ( int indice ) throws RegistroInexistente{
		removeDaLista( (ArrayList) this.cliente, indice);
	}
	
	public void Altera ( Cliente cliente) throws RegistroInexistente, RegistroJaExiste{
		alteraNaLista( (ArrayList) this.cliente, (Tabelavel) cliente);
	}
	
	public Cliente ConsultaCliente ( String chave ) throws RegistroInexistente{
		return (Cliente) consultaDaLista( (ArrayList) this.cliente, chave);
	}
	
	public Cliente ConsultaCliente ( int indice ) throws RegistroInexistente{
		return (Cliente) consultaDaLista( (ArrayList) this.cliente, indice);
	}
	

    public LinkedList<Cliente> ListCliente () {
    	
        LinkedList<Cliente> lista = new LinkedList<Cliente>();
        
        Cliente registro;
        
        for (int i = 0; i < cliente.size(); i++) {
           
            registro = cliente.get(i);
           
            if ( registro != null ) {
           
                lista.addLast(registro);
               
            }
           
        }
        
        return lista;
    }
	
	public void showMidia ( ) {
		
		Midia registro;
		
		for (int i = 0; i < midia.size(); i++) {
			
			registro = midia.get(i);
			
			if ( registro != null ) {
							
				System.out.println( "Mídia " + registro.getIndice() +
									" código " + registro.getCodigo() +
									" e descrição " + registro.getDescricao() + ".");
			
			}
			
		}
		
	}
	/*
	public static void main(String[] args) {
		//criacao banco
		Map banco = new HashMap();
		Map midias = new HashMap();
		Map clientes = new HashMap();
		banco.put(Entities.MIDIA, midias);
		banco.put(Entities.CLIENTES, clientes);
		
		//salvar um midia
		Map medias = (Map) banco.get(Entities.MIDIA);
		
		Midia midia = new Midia("1", "desc");
		medias.put(1,  midia);
		
		midia = new Midia("2", "desc");
		medias.put(2,  midia);
		
		medias.get(2);
		
		for (Iterator iterator =medias.entrySet().iterator(); iterator.hasNext();) {
				//entryset
	}	
		
		
	}
	*/
	 
}
